<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Real Estate Forecasting | Romeo Silvestri </title> <meta name="author" content="Romeo Silvestri"> <meta name="description" content="Master's Thesis on comparative analysis between Spatial Econometrics and Machine Learning models for housing price prediction."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://romeosilvestri.github.io/projects/master_thesis/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Romeo</span> Silvestri </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Real Estate Forecasting</h1> <p class="post-description">Master's Thesis on comparative analysis between Spatial Econometrics and Machine Learning models for housing price prediction.</p> </header> <article> <p>Real estate valuation is a complex task where location introduces strong spatial dependencies that standard models often fail to capture. This project, developed as my Master’s Thesis in Statistical Sciences, explores the intersection of classical Spatial Econometrics and modern Machine Learning to predict housing prices in Madrid.</p> <p><strong>Objectives</strong></p> <ol> <li> <strong>Data Engineering:</strong> Build a robust dataset by scraping and geocoding thousands of real estate listings.</li> <li> <strong>Missing Data Strategy:</strong> Compare and implement advanced imputation techniques (e.g., Random Forest vs. Predictive Mean Matching) to handle incomplete records.</li> <li> <strong>Model Benchmarking:</strong> Evaluate whether explicitly modeling spatial dependence (Spatial Error/Lag Models) outperforms algorithmic approaches (XGBoost, Random Forest).</li> </ol> <p><strong>My role</strong></p> <ul> <li>End-to-end data pipeline development (Web Scraping -&gt; Cleaning -&gt; Imputation).</li> <li>Statistical analysis of spatial autocorrelation (Moran’s I, LISA Clusters).</li> <li>Implementation and tuning of predictive models.</li> <li>Comparative analysis of error metrics (RMSE, MAE).</li> </ul> <p><br></p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <h5> <i class="fas fa-layer-group"></i> Tech Stack</h5> <table class="table table-borderless table-sm"> <tbody> <tr> <th scope="row">Language</th> <td>R</td> </tr> <tr> <th scope="row">Spatial Stats</th> <td>spdep, spatialreg, sf, tmap</td> </tr> <tr> <th scope="row">ML Models</th> <td>xgboost, randomForest, caret</td> </tr> <tr> <th scope="row">Tools</th> <td>ArcGIS (Geocoding), OpenStreetMap</td> </tr> </tbody> </table> </div> <div class="col-sm mt-3 mt-md-0"> <h5> <i class="fas fa-code-branch"></i> Project Structure</h5> <p>The workflow follows a rigorous statistical framework:</p> <ul class="list-group list-group-flush"> <li class="list-group-item p-1"><small><code>01_data_collection</code> Scraping &amp; Geocoding</small></li> <li class="list-group-item p-1"><small><code>02_imputation</code> Missing data handling (I-Score)</small></li> <li class="list-group-item p-1"><small><code>03_spatial_esda</code> Moran's I &amp; LISA Clustering</small></li> <li class="list-group-item p-1"><small><code>04_modeling</code> SEM/SAR vs XGBoost/RF</small></li> </ul> </div> </div> <hr> <h3 id="the-challenge-spatial-dependence--data-quality">The Challenge: Spatial Dependence &amp; Data Quality</h3> <p>The dataset consists of <strong>6,287 properties</strong> in Madrid, collected in March 2020. Real-world data is rarely perfect: significant portions of the data (up to 48% for some variables like “Independent Heating”) were missing.</p> <p>Furthermore, housing prices violate the assumption of independence required by standard linear models: the price of a house is strongly correlated with the price of its neighbors (<strong>Spatial Autocorrelation</strong>).</p> <p><strong>Key Challenges:</strong></p> <ul> <li> <strong>Missing Data (MAR):</strong> Analyzing the mechanism of missingness (Missing At Random) to apply the correct imputation strategy without introducing bias.</li> <li> <strong>Spatial Heterogeneity:</strong> The relationship between variables changes across different neighborhoods (spatial sub-markets).</li> </ul> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/master_thesis/madrid_map.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Madrid Price Map" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Spatial distribution of housing prices in Madrid. The clustering of high/low values suggests strong spatial autocorrelation. </div> <h3 id="methodology">Methodology</h3> <p>The analysis adopted a hybrid approach, testing both “Explicit” and “Implicit” spatial modeling:</p> <ol> <li> <strong>Data Preprocessing &amp; Imputation:</strong> Comparing multiple imputation methods using the <strong>I-Score</strong> metric. <em>Random Forest Imputation</em> proved to be the most effective at preserving the original data distribution.</li> <li> <strong>Spatial Analysis (ESDA):</strong> Using Global Moran’s I to detect autocorrelation and <strong>LISA (Local Indicators of Spatial Association)</strong> to identify “hotspots” (High-High price clusters) and “coldspots” (Low-Low clusters).</li> <li> <strong>Modeling Strategies:</strong> <ul> <li> <strong>Spatial Econometrics:</strong> Spatial Error Model (SEM) and Spatial Lag Model (SAR) to explicitly model the error structure or the dependent variable lag.</li> <li> <strong>Machine Learning:</strong> Random Forest and XGBoost.</li> <li> <strong>Hybrid Approach:</strong> Using spatial features (LISA Cluster IDs) as input features for tree-based models (“Implicit Spatial Regression”).</li> </ul> </li> </ol> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/master_thesis/spatial_residuals.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Residual Analysis" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Residual maps comparison: The Spatial Error Model (left) vs. XGBoost (right). The goal is to minimize spatial patterns in the errors (white noise). </div> <h3 id="results-the-power-of-context">Results: The Power of Context</h3> <p>The results highlighted a trade-off between <strong>explainability</strong> and <strong>predictive power</strong>.</p> <p>While Spatial Econometrics models (SEM) provided excellent theoretical insights into the spatial structure of the errors, they underperformed in pure prediction accuracy compared to ensemble methods.</p> <p><strong>Key Findings:</strong></p> <ul> <li> <strong>XGBoost</strong> outperformed all traditional statistical models.</li> <li> <strong>The Hybrid Winner:</strong> The best performance was achieved by an <strong>XGBoost model enriched with spatial features</strong> (LISA cluster IDs). This approach captured local spatial heterogeneity better than global spatial parameters.</li> </ul> <p><strong>Performance Metrics (RMSE):</strong></p> <ul> <li> <strong>Spatial Error Model (SEM):</strong> ~242,000 €</li> <li> <strong>Linear Regression:</strong> ~208,000 €</li> <li> <strong>XGBoost (Hybrid):</strong> <strong>~142,000 €</strong> </li> </ul> <p>The hybrid model explained <strong>89.9%</strong> of the variance in housing prices, reducing the average error significantly compared to traditional methods.</p> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/master_thesis/model_comparison.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="RMSE Comparison" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> RMSE comparison across all tested models. Tree-based models (XGBoost, RF) show significantly lower prediction errors. </div> <p><br></p> <h5> <i class="fas fa-file-pdf"></i> Full Documentation</h5> <div class="publications"> <p>For a deep dive into the mathematical formulation of the Spatial Error Models and the complete variable analysis, you can access the full documents below:</p> <a href="/assets/pdf/thesis/thesis_full.pdf" class="btn btn-sm z-depth-0" role="button">Read Full Thesis</a> <a href="/assets/pdf/thesis/presentation_slides.pdf" class="btn btn-sm z-depth-0" role="button">View Presentation Slides</a> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2026 Romeo Silvestri. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?c15de51d4bb57887caa2c21988d97279"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> </body> </html>